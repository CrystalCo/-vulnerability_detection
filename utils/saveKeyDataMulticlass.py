#!/usr/bin/env python
# coding: utf-8

from utils.utils import GetData, SaveData

def saveKeyDataMulticlass(input_path, label_encoder, output_path=None):
    """
        Saves the encoded labels to the dataset that will be used to fit the DL model.
        input_path  :=  str; Balanced Final Train & Test Final sets in ./data/DLvectors/
        label_encoder := obj; the one used to encode the original labels
        output_path :=  str; If none, will overwrite the file from the input path.
    """
    print("\nSaving key data...")
    data = GetData(input_path)
    y = data[-2]
    encoded_y = label_encoder.transform(y)
    data[-2] = encoded_y
    
    if not output_path:
        # Save as this original pkl file b/c that's what the Keras model will use.
        SaveData(input_path, data)
        print("Saved in " + input_path)
    else:
        SaveData(output_path, data)
        print("Saved in " + output_path)
