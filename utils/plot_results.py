import os

import numpy as np
from MLMethods import get_metrics_from_logs, plot_loss_vs_X_per_epoch

logs_path = os.path.join('logs')
plot_path = os.path.join('data', 'plots')
plot_loss_path = os.path.join(plot_path, 'losses_vs___per_epoch')

# Loss vs Categorical Accuracies over epochs figure
model_names, loss_scores = get_metrics_from_logs(logs_path, 'loss')
_, accuracy_scores = get_metrics_from_logs(logs_path, 'categorical_accuracy')

# Plot Loss and Catgeorical Accuracy over epochs figure
for i in range(len(model_names)):
    plot_loss_vs_X_per_epoch(model_names[i], loss_scores[i], accuracy_scores[i], 'Categorical Accuracy', plot_loss_path)

# Plot Loss and Recall over epochs figure
model_names, recall_scores = get_metrics_from_logs(logs_path, 'recall')
for i in range(len(model_names)):
    plot_loss_vs_X_per_epoch(model_names[i], loss_scores[i], recall_scores[i], 'Recall', plot_loss_path)

