import os

import numpy as np
from MLMethods import get_metrics_from_logs, plot_loss_vs_X_per_epoch

NUM_EPOCHS = 20
logs_path = os.path.join('logs')

# Loss vs Categorical Accuracies over epochs figure
model_names, loss_scores = get_metrics_from_logs(logs_path, NUM_EPOCHS, 'loss')
_, accuracy_scores = get_metrics_from_logs(logs_path, NUM_EPOCHS, 'categorical_accuracy')

plot_path = os.path.join('data', 'plots')
plot_loss_path = os.path.join(plot_path, 'losses_vs___per_epoch')
epochs = np.arange(1, NUM_EPOCHS+1)
for i in range(len(model_names)):
    # plot losses vs _
    plot_loss_vs_X_per_epoch(model_names[i], epochs, loss_scores[i], accuracy_scores[i], 'Categorical Accuracy', plot_loss_path)

# Loss vs Recall over epochs figure
model_names, recall_scores = get_metrics_from_logs(logs_path, NUM_EPOCHS, 'recall')
for i in range(len(model_names)):
    # plot losses vs _
    plot_loss_vs_X_per_epoch(model_names[i], epochs, loss_scores[i], recall_scores[i], 'Recall', plot_loss_path)

