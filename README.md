# Setup
To download this repository, clone it using git:
`git clone https://github.com/CrystalCo/vulnerability_detection.git`

## Step 0:
If the files in slicesSource are not compressed, you may skip this step. Otherwise do the following:
    (Requires installation of git lfs.  If you don't have git lfs installed yet, install it by going to https://git-lfs.github.com/, download based on operating system, then run  `git lfs install`.
    Run `git lfs pull` to unzip the large files. 

## Step 1

Create an ENV variable with the path to this project, and call it `VUL_PATH`.
On Unix/MacOS example:
```
export VUL_PATH=`pwd`
```
or manually:
```
$ export VUL_PATH=/mnt/c/Users/cryst/Documents/vulnerability_detection
```

## Step 2
Create a virtual environment:
```
python3 -m virtualenv env
```

Activate virtual environment:
```
source env/bin/activate
```

Install requirements:
```
pip install -r requirements.txt 
```

## Step 3
Make sure the following folders are inside the data directory:
CVE/
CWE/
DLinputs/train/
DLinputs/test/
DLvectors/train/
DLvectors/test/
MLinputs/train/
MLinputs/test/
MLvectors/train/
MLvectors/test/
plots/
slicesSource/
token/SARD/
tokenD2V/SARD/
vector/
vectoD2V/



# 0_SYSE_source2slice
Original code that converts source code to slices.


# SYSE_1_isVulnerable
Contains the original source code for vulnerability detection.
`2_Application_Codes.ipynb` is the main file to run in this folder.  It uses BGRU & BLSTM to detect whether a slice of code contains a vulnerability or not.


# SYSE_2_vulnerabilityType
Contains the follow up code that attempts to categorize the type of vulnerability.

## CWE_Data_Preprocessing
`CWE_Data_Preprocessing.ipynb` was the first step in preprocessing the data.  It collects the SARD & CVE test case IDs for all the source slices we have.  Then, it scrapes the Internet for the CWE attributes for each SARD & CVE ID. Finally, it ouputs 2 files: `CWE_DF.csv` & `CVE_DF.csv`.
CWE_DF.csv contains all the unique CWE IDs, their details, and counts*.
CVE_DF.csv contains all the unique CVE IDs, their descriptions & counts*, and the CWE-ID associated with them if applicable.

*number of times they appear in the source code file.

## Grouping_By_Abstraction
`Grouping_By_Abstraction.ipynb` then collects all the CWE IDs found in the previous step, and creates a tree of relationships between these CWEs.  CWEs were grouped by similarity, defined by the cwe website.  A dictionary of SARD & CVE IDs mapped to their respective group ID is created, and saved to `SARD_CVE_to_groups.csv`.

## Clustering_ML
`Clustering_ML.ipynb` attempts to group CWEs by similarities using KMeans & Hierarchical clustering.  If successful, we would have grouped CWEs by these clusters for later classification.

## 3A_Vulnerability_Classification_ML
`3A_Vulnerability_Classification_ML.ipynb` attempts to classify vulnerability type using ML models.

## 3B_Vulnerability_Classification_DL
`3B_Vulnerability_Classification_DL.ipynb` attempts to classify vulnerability type using DL models.


